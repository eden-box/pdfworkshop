language: python

cache: pip

branches:
  only:
    - master
    - unit-tests

# ===== Linux ======
dist: xenial

python:
  - 3.6
  - 3.7

matrix:
  include:
    #  ====== WINDOWS =========
    - name: "Python 3.6.10 on Windows"
      os: windows
      language: shell       # 'language: python' is an error on Travis CI Windows
      before_install:
        - choco install make
        - choco install python --version 3.6.8
        - python --version
        - python -m pip install --upgrade pip
      env: PATH=/c/Python36:/c/Python36/Scripts:$PATH

    - name: "Python 3.7.6 on Windows"
      os: windows
      language: shell       # 'language: python' is an error on Travis CI Windows
      before_install:
        - choco install make
        - choco install python --version 3.7.6
        - python --version
        - python -m pip install --upgrade pip
      env: PATH=/c/Python37:/c/Python37/Scripts:$PATH

# command to install dependencies
install:
  - python -m pip install poetry
  - make devsetup

# command to run tests
script:
  - make autotest
